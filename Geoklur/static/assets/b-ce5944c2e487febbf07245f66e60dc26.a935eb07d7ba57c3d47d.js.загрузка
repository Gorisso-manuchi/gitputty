(self.webpackChunkvk=self.webpackChunkvk||[]).push([[410],{95283:function(t,e,n){"use strict";n.d(e,{decodeHTMLEntities:function(){return i}});n(98884);var o=n(49849),r=o.symbols;o.encodeHTMLEntities,o.escape;function i(t){return r.reduce(((t,e)=>{var[n,o]=e;return t.replace(new RegExp(n,"ig"),o)}),t).replace(/&#(\d+);/g,((t,e)=>String.fromCodePoint(e)))}},60201:function(t,e,n){"use strict";n.d(e,{createReactInitiator:function(){return f},createReactContainer:function(){return _},getReactContainer:function(){return h},removeReactContainer:function(){return p},showComponent:function(){return g},showAlert:function(){return v}});var o=n(91896),r=n(93176),i=n(71437),s=n(20848),u=n(62641),a=n(82917),c=n(18226),l=n(45582),d={environment:"react"};function f(t,e,n){var o;function i(){return o=(0,u.isJSFunction)(e)?e()||o:e,document.body.contains(o)&&o||null}var s=(0,u.getRandomId)(),a=!1,f=null,_=function(){if(a){a=!1;var t=((0,u.isJSFunction)(e)?e():null)||i()||f;if(t){if(!(r.unmountComponentAtNode(t)||f&&r.unmountComponentAtNode(f))){var c="Failed to unmount react node";console.error(c),(0,l.logError)(new Error(c),d)}}else{c="Can't find react DOM node to deactivate it.";console.error(c),(0,l.logError)(new Error(c),d)}o=null,s="",null==n||n(),f=null}};return{activate:function(e){if(!a){if(a=!0,!(0,u.isJSFunction)(t))return f=i(),r.render(t,f),void(0,c.onElementRemove)(f,(function(){return _()}));if(e){var n=s;t(e).then((function(t){s===n&&(f=i(),r.render(t,f),(0,c.onElementRemove)(f,(function(){return _()})))}))}}},deactivate:_}}function _(t){var e="rc_"+t,n=document.createElement("div");return n.id=e,document.body.appendChild(n),n}function h(t){var e="rc_"+t;return document.getElementById(e)||_(t)}function p(t){var e="rc_"+t,n=(0,i.$)("#"+e);!function(t){var e="rc_"+t,n=(0,i.$)("#"+e);try{r.unmountComponentAtNode(n)}catch(t){}}(t),(0,s.remove)(n)}function g(t){var e=_((0,s.srand)()),n=function(){},o=f(t((function(){return n()})),e);return n=function(){o.deactivate(),(0,s.remove)(e)},o.activate(),o.deactivate}function v(t){return g((function(e){return(0,o.jsx)(a.StandaloneModalRoot,{popout:t(e)},void 0)}))}},85221:function(t,e,n){"use strict";n.d(e,{onInteractionMethodChange:function(){return r},initInteractionMethodListener:function(){return s},getLastInteractionMethod:function(){return a}});var o=n(72864),r=(0,o.createEvent)("onInteractionMethodChange"),i=(0,o.createStore)("coarse").on(r,(function(t,e){return e}));function s(){window.clog("[UserInteraction] init"),"matchMedia"in window?(window.matchMedia("(pointer: coarse)").addEventListener("change",(function(t){t.matches&&r("coarse")})),window.matchMedia("(pointer: fine)").addEventListener("change",(function(t){t.matches&&r("fine")}))):u()}function u(){document.addEventListener("mouseenter",(function t(){r("fine"),document.removeEventListener("mouseenter",t,{capture:!0}),function(){function t(e){var n;(null===(n=e.sourceCapabilities)||void 0===n?void 0:n.firesTouchEvents)||(r("coarse"),document.removeEventListener("touchstart",t,{capture:!0}),u())}document.addEventListener("touchstart",t,{passive:!0,capture:!0})}()}),{passive:!0,capture:!0})}function a(){return i.getState()}i.watch((function(t){window.clog("[UserInteraction] Last interaction method changed to "+t)}))},82917:function(t,e,n){"use strict";n.d(e,{StandaloneModalRoot:function(){return u}});var o=n(79573),r=n(91896),i=n(34158),s=n(75280),u=function(t){var e=t.modal,n=t.popout,u=t.children,a=t.shouldLockBodyScroll;return(0,r.jsx)(i.VKUIAppWrapper,(0,o.__assign)({shouldLockBodyScroll:a},{children:(0,r.jsx)("div",(0,o.__assign)({className:"StandaloneModalRoot"},{children:(0,r.jsx)(s.AppRoot,(0,o.__assign)({mode:"embedded",noLegacyClasses:!0,style:{backgroundColor:"transparent"}},{children:(0,r.jsx)(s.SplitLayout,{modal:u||e,popout:n},void 0)}),void 0)}),void 0)}),void 0)}},34158:function(t,e,n){"use strict";n.d(e,{VKUIAppWrapper:function(){return f}});var o,r=n(79573),i=n(91896),s=n(56769),u=n(75280),a=n(85221),c=n(20848),l=n(90616),d=((o={})[u.ViewWidth.DESKTOP]=1024,o[u.ViewWidth.TABLET]=882,o[u.ViewWidth.SMALL_TABLET]=620,o[u.ViewWidth.MOBILE]=320,o[u.ViewWidth.SMALL_MOBILE]=180,o);var f=function(t){var e,n=(0,r.__read)((0,s.useState)("fine"===(0,a.getLastInteractionMethod)()),2),o=n[0],f=n[1],_=(0,r.__read)((0,s.useState)((0,c.getCw)()),2),h=_[0],p=_[1],g=(0,s.useRef)(null);return(0,s.useEffect)((function(){var e=function(){p((0,c.getCw)())};return window.addEventListener("resize",e),t.shouldLockBodyScroll&&(null==g?void 0:g.current)&&(0,l.disableBodyScroll)(g.current),function(){window.removeEventListener("resize",e),t.shouldLockBodyScroll&&(0,l.enableBodyScroll)()}}),[]),(0,s.useEffect)((function(){var t=a.onInteractionMethodChange.watch((function(t){f("fine"===t)}));return function(){t()}}),[]),(0,i.jsx)(u.AdaptivityProvider,(0,r.__assign)({hasMouse:o,viewWidth:(e=h,e>=d[u.ViewWidth.DESKTOP]?u.ViewWidth.DESKTOP:e>=d[u.ViewWidth.TABLET]?u.ViewWidth.TABLET:e>=d[u.ViewWidth.SMALL_TABLET]?u.ViewWidth.SMALL_TABLET:e>=d[u.ViewWidth.MOBILE]?u.ViewWidth.MOBILE:u.ViewWidth.SMALL_MOBILE)},{children:(0,i.jsx)(u.ConfigProvider,(0,r.__assign)({isWebView:!0,scheme:"inherit",platform:u.Platform.ANDROID,transitionMotionEnabled:!1,webviewType:u.WebviewType.INTERNAL},{children:(0,i.jsx)("div",(0,r.__assign)({className:"VKUIAppWrapper",ref:g},{children:t.partial?(0,i.jsx)(u.AppRoot,(0,r.__assign)({mode:"partial",noLegacyClasses:!0},{children:t.children}),void 0):t.children}),void 0)}),void 0)}),void 0)}},4992:function(t,e,n){"use strict";n.d(e,{$additionalParams:function(){return At},$authors:function(){return vt},$deletedQuestions:function(){return ht},$deletedQuestionsCount:function(){return pt},$isLoading:function(){return yt},$ownerId:function(){return _t},$popout:function(){return St},$questions:function(){return gt},$snackbar:function(){return wt},$totalQuestionsCount:function(){return mt},banAuthor:function(){return G},closeShowQuestionsBox:function(){return nt},copyAskRequestLink:function(){return J},deleteAllAuthorQuestions:function(){return H},deleteQuestion:function(){return D},loadQuestions:function(){return W},openAskRequestStoryPublisher:function(){return X},openAuthorProfile:function(){return Y},openQuestionActionsMenu:function(){return V},reportQuestion:function(){return $},restoreAllAuthorQuestions:function(){return j},restoreQuestion:function(){return F},setForceContentScroll:function(){return et},setQuestionAnsweredFx:function(){return dt},setShowQuestionsBoxAdditionalParams:function(){return tt},setShowQuestionsBoxOwnerId:function(){return N},setShowQuestionsBoxParams:function(){return ot},unbanAuthor:function(){return K}});var o=n(79573),r=n(91896),i=n(72864),s=n(51888),u=n(20848),a=n(75280),c=n(62641),l=n(32609),d=n(64260),f=function(t){var e=t.onClose,n=t.toggleRef,i=t.question,s=t.author,f=(0,c.getLangReplace)((0,u.getLang)("mobile_profile_questions_open_profile"),{name:String(null==s?void 0:s.first_name_gen)}),_=i.is_anonymous?(0,u.getLang)("mobile_profile_questions_ban_profile"):(0,c.getLangReplace)((0,u.getLang)("mobile_profile_questions_ban_named_profile"),{name:String(null==s?void 0:s.first_name_gen)}),h=i.is_anonymous?(0,u.getLang)("mobile_profile_questions_unban_profile"):(0,c.getLangReplace)((0,u.getLang)("mobile_profile_questions_unban_named_profile"),{name:String(null==s?void 0:s.first_name_gen)}),p=i.is_author_blocked?h:_;return(0,r.jsxs)(a.ActionSheet,(0,o.__assign)({onClose:e,toggleRef:n},{children:[i.is_anonymous?null:(0,r.jsx)(a.ActionSheetItem,(0,o.__assign)({onClick:function(){return Y(i)},autoclose:!0},{children:f}),void 0),(0,r.jsx)(a.ActionSheetItem,(0,o.__assign)({onClick:function(){return function(t){$(t)}(i)},autoclose:!0},{children:(0,u.getLang)("mobile_profile_questions_report_question")}),void 0),(0,r.jsx)(a.ActionSheetItem,(0,o.__assign)({onClick:function(){return i.is_author_blocked?function(t){K(t),(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.unblock,{questionId:t.id,questionReceiverId:window.vk.id})}(i):function(t){G(t),(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.block,{questionId:t.id,questionReceiverId:window.vk.id})}(i)},autoclose:!0},{children:p}),void 0),(0,r.jsx)(a.ActionSheetItem,(0,o.__assign)({onClick:function(){return function(t){D(t),(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.delete,{questionId:t.id,questionReceiverId:window.vk.id})}(i)},autoclose:!0,mode:"destructive"},{children:(0,u.getLang)("mobile_profile_questions_delete_question")}),void 0)]}),void 0)},_=function(t){return t.reduce((function(t,e){return t[e.id]=e,t}),{})},h=n(74930),p=n(31927),g=n(73283),v=n(59367),m=n(89746),E=136,y=144,T="VK Sans Display, SF Pro Text, sans-serif",S="600",w="#000",A="#fff",I=48,b=64,k=40,x=72,R=72,L=function(t){function e(e){var n=t.call(this)||this;return n.props=e,n}return(0,o.__extends)(e,t),e.prototype.render=function(){var t=this;return new Promise((function(e){t.draw(),e(1)}))},e.prototype.draw=function(){var t=new m.TextItem({text:this.props.text,fontSize:E,lineHeight:y,fontFamily:T,fontWeight:S,color:w,fillColor:A,fillRadius:I,padding:{top:b,bottom:k,left:x,right:R}});this.add(t),this.setWidth(t.getWidth()),this.setHeight(t.getHeight()),this.drawScene()},e}(v.Sticker),C=n(69410),Q=function(t){function e(e){var n=t.call(this)||this;return n.props=e,n}return(0,o.__extends)(e,t),e.prototype.render=function(){var t=this;return new Promise((function(e,n){t.loadImages({photo:t.props.photoUrl}).then((function(){t.draw(),e(1)})).catch((function(t){n(t)}))}))},e.prototype.draw=function(){var t=this.props,e=t.size,n=t.borderSize,o=void 0===n?0:n,r=t.borderColor,i=void 0===r?"":r,s=4*e,u=4*o,a=new C.ImageItem({image:this.getImage("photo"),width:s,height:s,radius:s/2,borderSize:u,borderColor:i});this.add(a),this.setWidth(a.getWidth()),this.setHeight(a.getHeight()),this.drawScene()},e}(v.Sticker),q=n(61540),P=function(){var t=document.createElement("canvas");t.width=1080,t.height=1920;var e,n,o=t.getContext("2d"),r="",i="";return new Promise((function(t,e){window.ajax.post("stories.php",{act:"get_profile_question_ask_request_story_data"},{onDone:t,onError:e,onFail:e})})).then((function(o){var s,u=o.backgrounds,a=o.stickerText,c=o.avatarUrl;if(r=o.getStoryUploadUrlHash,i=o.saveStoryHash,e=new Q({photoUrl:c,size:.41*t.width/4,borderSize:4,borderColor:"#fff"}),n=new L({text:a}),null==u?void 0:u.length){var l=String(null===(s=u[Math.round(Math.random()*u.length-1)])||void 0===s?void 0:s.url);return(0,p.loadImage)(l).catch((function(t){return console.error(t),Promise.resolve()}))}})).then((function(t){return t&&(null==o||o.drawImage(t,0,0)),Promise.all([e.render(),n.render()])})).then((function(){var r=.075*t.width,i=e.getWidth(),s=e.getHeight(),u=n.getWidth(),a=n.getHeight(),c=Math.min(u,.76*t.width)/u,l=u*c,d=a*c;return null==o||o.drawImage(e.getCanvas(),r,.17*t.height,i,s),null==o||o.drawImage(n.getCanvas(),r,.63*t.height,l,d),t.toDataURL("image/jpeg",1)})).then((function(t){return new Promise((function(e,n){var o,s;null===(o=window.StoryPublisher)||void 0===o||o.init({entrypoint:"profile_question",questionId:-1,src:t,background_type:g.StoryPublisherBackgroundType.IMAGE,storyUploadUrlHash:r,storySaveHash:i,closeAfterError:!0,attachment:{type:"url",text:"questions",url:"https://"+(0,q.getHostName)()+"/question/ask"+(null===(s=window.vk)||void 0===s?void 0:s.id)}},(function(){}),(function(t,o){t?e({isPublished:t,isEscaped:!1,story:null==o?void 0:o.story}):o?n(o):e({isPublished:!1,isEscaped:!0})}))}))}))},O=n(53271),M=(0,i.createDomain)("MvkShowQuestionsModal"),N=M.createEvent(),W=M.createEvent(),U=M.createEvent(),D=M.createEvent(),F=M.createEvent(),V=M.createEvent(),B=M.createEvent(),H=M.createEvent(),j=M.createEvent(),Y=(M.createEvent(),M.createEvent(),M.createEvent()),G=M.createEvent(),K=M.createEvent(),$=M.createEvent(),z=M.createEvent(),X=M.createEvent(),J=M.createEvent(),Z=M.createEvent(),tt=M.createEvent(),et=M.createEvent(),nt=M.createEvent(),ot=M.createEvent();Y.watch((function(t){(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.openProfile,{questionId:t.id,questionReceiverId:window.vk.id}),window.nav.hard_go("/id"+t.user_id_from+"?from=question")})),X.watch((function(){P().then((function(t){var e=t.isPublished,n=t.story;e&&z((0,r.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,action:(0,u.getLang)("mobile_profile_questions_show_story"),before:null,onActionClick:function(){return(0,h.showStoryWithAnswer)(n.owner_id,n.id)}},{children:(0,u.getLang)("mobile_profile_questions_success_shared_to_story")}),void 0))})).catch(console.error)})),J.watch((function(){(0,O.copyToClipboard)("https://"+(0,q.getHostName)()+"/question/ask"+window.vk.id),(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.copyLink,{questionReceiverId:window.vk.id}),z((0,r.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,before:null},{children:(0,u.getLang)("mobile_profile_questions_share_success_copy_url")}),void 0))}));var rt=M.createEffect((function(t){var e=t.question,n=t.questions;return(0,s.banUser)(e.id).then((function(){var t=0,i=!1;n.forEach((function(e){e.user_id_from==e.user_id_from&&t++,t>1&&(i=!0)}));var s=(0,u.getLang)("mobile_profile_questions_delete_question_label"),c=(0,u.getLang)("mobile_profile_questions_delete_author_question");e.is_anonymous?i=!1:i&&(s=(0,u.getLang)("mobile_profile_questions_delete_questions_label"),c=(0,u.getLang)("mobile_profile_questions_delete_author_questions")),z((0,r.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,action:s,before:null,onActionClick:function(){return i?H(e):D(e)}},{children:c}),void 0))}))})),it=M.createEffect((function(t){return(0,s.reportQuestion)(t.id).then((function(){z((0,r.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,before:null},{children:(0,u.getLang)("mobile_profile_questions_report_sended")}),void 0))}))})),st=M.createEffect((function(t){return(0,s.deleteFromAuthor)(t.id)})),ut=M.createEffect((function(t){return(0,s.restoreAuthorQuestions)(t.id)})),at=M.createEffect((function(t){return(0,s.deleteQuestion)(t.id)})),ct=M.createEffect((function(t){var e=t.startFrom,n=t.isReload;return(0,s.getQuestions)(n?"":e).then((function(t){return{response:t,isReload:n}}))})),lt=M.createEffect((function(t){return(0,s.restoreQuestion)(t.id)})),dt=M.createEffect((function(t){var e=t.question,n=t.story;return(0,s.getQuestion)(e.id).then((function(t){return t.question?(z((0,r.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,action:(0,u.getLang)("mobile_profile_questions_show_story"),before:null,onActionClick:function(){return(0,h.showStoryWithAnswer)(null==n?void 0:n.owner_id,null==n?void 0:n.id)}},{children:(0,u.getLang)("mobile_profile_questions_success_answered")}),void 0)),t):Promise.reject()}))})),ft=M.createEffect((function(t){return(0,s.unbanUser)(t.id).then((function(){z((0,r.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,before:null},{children:(0,u.getLang)("mobile_profile_questions_author_unblocked")}),void 0))}))})),_t=M.createStore(null).reset(nt),ht=M.createStore({}),pt=M.createStore(0),gt=M.createStore([]),vt=M.createStore({}),mt=M.createStore(0),Et=M.createStore(""),yt=(0,i.combine)({isLoadingQuestions:ct.pending,isDeleteAllAuthorQuestions:st.pending,isRestoreAllAuthorQuestions:ut.pending},(function(t){var e=t.isLoadingQuestions,n=t.isDeleteAllAuthorQuestions,o=t.isRestoreAllAuthorQuestions;return e||n||o})),Tt=(0,i.combine)(gt,mt,(function(t,e){return t.length>=e})),St=M.createStore(null),wt=M.createStore(null),At=M.createStore({}).reset(nt),It=M.createStore((function(){}));Z.watch((function(t){return null==t?void 0:t()})),It.on(et,(function(t,e){return e})),At.on(tt,(function(t,e){return e})),gt.on(ct.doneData,(function(t,e){var n=e.response;return e.isReload?n.items:function(t){var e={};return t.filter((function(t){return!e[t.id]&&(e[t.id]=!0,!0)}))}((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(t),!1),(0,o.__read)(n.items),!1))})).on(G,(function(t,e){return t.map((function(t){return t.user_id_from===e.user_id_from&&(t.is_author_blocked=!0),t}))})).on(K,(function(t,e){return t.map((function(t){return t.user_id_from===e.user_id_from&&(t.is_author_blocked=!1),t}))})).on(dt.doneData,(function(t,e){return t.map((function(t){return t.id===e.question.id?e.question:t}))})).on(H,(function(){return[]})).on(j,(function(){return[]})),vt.on(ct.doneData,(function(t,e){var n=e.response,r=_(n.profiles);return(0,o.__assign)((0,o.__assign)({},t),r)})).on(dt.doneData,(function(t,e){var n=_(e.profiles);return(0,o.__assign)((0,o.__assign)({},t),n)})),mt.on(ct.doneData,(function(t,e){return e.response.count||0})).on(D,(function(t){return t-1})).on(F,(function(t){return t+1})),Et.on(ct.doneData,(function(t,e){return e.response.next_from})),pt.on(D,(function(t){return t+1})).on(F,(function(t){return t-1})),ht.on(D,(function(t,e){var n,o,r,i=(0,h.getQuestionAuthorVirtualId)(e);return Object.assign({},t,((n={})[i]=Object.assign({},t[i],((o={})[e.id]=!0,o.count=((null===(r=t[i])||void 0===r?void 0:r.count)||0)+1,o.lastDeleteTrigger=e,o)),n))})).on(F,(function(t,e){var n,o,r,i=(0,h.getQuestionAuthorVirtualId)(e);return Object.assign({},t,((n={})[i]=Object.assign({},t[i],((o={})[e.id]=!1,o.count=((null===(r=t[i])||void 0===r?void 0:r.count)||0)-1,o)),n))})).on(H,(function(t,e){var n,o=(0,h.getQuestionAuthorVirtualId)(e);return Object.assign({},t,((n={})[o]=Object.assign({},t[o],{deleteAllTrigger:e}),n))})).on(j,(function(t,e){var n,o=(0,h.getQuestionAuthorVirtualId)(e);return Object.assign({},t,((n={})[o]=Object.assign({},t[o],{deleteAllTrigger:void 0}),n))})).on(ct.doneData,(function(t,e){if(e.isReload)return(0,h.getCleanedDeletedAuthorsTriggers)(t)})),_t.on(N,(function(t,e){return e})),St.on(V,(function(t,e){var n=e.event,o=e.question,i=e.author;return(0,r.jsx)(f,{onClose:B,toggleRef:n.currentTarget,question:o,author:i},void 0)})).reset(B),wt.on(z,(function(t,e){return e})),(0,i.sample)({clock:ut.done,target:U}),(0,i.sample)({clock:st.done,target:U}),(0,i.sample)({clock:_t,target:U}),(0,i.sample)({clock:U,fn:function(){return{isReload:!0}},target:W}),(0,i.sample)({clock:[at.done,lt.done],source:It,target:Z}),(0,i.guard)({clock:D,filter:at.pending.map((function(t){return!t})),target:at}),(0,i.guard)({clock:F,filter:lt.pending.map((function(t){return!t})),target:lt}),(0,i.guard)({clock:H,filter:st.pending.map((function(t){return!t})),target:st}),(0,i.guard)({clock:j,filter:ut.pending.map((function(t){return!t})),target:ut}),(0,i.guard)({clock:W,filter:function(t,e){void 0===e&&(e={});var n=e.isReload,o=t.isLoading,r=t.isAllLoaded;return!!n||!o&&!r},source:{startFrom:Et,isLoading:yt,isAllLoaded:Tt,isReload:(0,i.restore)(W.map((function(t){return null==t?void 0:t.isReload})),!1)},target:ct}),(0,i.sample)({clock:G,fn:function(t,e){return{question:e,questions:t}},source:gt,target:rt}),(0,i.guard)({clock:K,filter:ft.pending.map((function(t){return!t})),target:ft}),(0,i.guard)({clock:$,filter:it.pending.map((function(t){return!t})),target:it})},74930:function(t,e,n){"use strict";n.d(e,{getQuestionAuthorVirtualId:function(){return u},getRestoreDeletedAuthorsTriggers:function(){return a},getCleanedDeletedAuthorsTriggers:function(){return c},updateQuestionInputHeight:function(){return l},onQuestionContentChange:function(){return d},showStoryWithAnswer:function(){return f}});var o=n(79573),r=n(98966),i=n(41319),s=n(34757),u=function(t){return t.is_anonymous?-1:Number(null==t?void 0:t.user_id_from)},a=function(t){var e,n,r={restoreAuthorTriggers:[]};if(!t)return r;try{for(var i=(0,o.__values)(Object.entries(t)),s=i.next();!s.done;s=i.next()){var u=(0,o.__read)(s.value,2),a=u[0],c=u[1];c.deleteAllTrigger&&(-1===Number(a)?r.restoreAnonymousTrigger=c.deleteAllTrigger:r.restoreAuthorTriggers.push(c.deleteAllTrigger))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},c=function(t){var e,n,r={};if(!t)return r;try{for(var i=(0,o.__values)(Object.entries(t)),s=i.next();!s.done;s=i.next()){var u=(0,o.__read)(s.value,2),a=u[0],c=u[1];r[a]={deleteAllTrigger:c.deleteAllTrigger}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},l=function(t){t&&(t.style.height="auto",requestAnimationFrame((function(){var e=t.scrollHeight;t.style.height=e+"px"})))},d=function(t,e){var n=t.target.value,o=(n=n.replace(/(\n|\s){2,}/g,"$1")).split("\n");o.length>r.QUESTION_MAX_NEW_LINES&&(n=o.reduce((function(t,e,n){return n<r.QUESTION_MAX_NEW_LINES-1?t+=e+"\n":t+=e+" ",t}),"")),null==e||e(n.slice(0,r.QUESTION_MAX_LENGTH)),l(t.target)},f=function(t,e){(0,s.addStatic)(["stories.js"]).then((function(){window.Stories.init(t+"/"+t+"_"+e,{source:i.StorySource.MY_QUESTIONS})}))}},73283:function(t,e,n){"use strict";var o;n.d(e,{StoryPublisherBackgroundType:function(){return o}}),function(t){t.IMAGE="image",t.VIDEO="video"}(o||(o={}))},53271:function(t,e,n){"use strict";function o(t){return navigator.clipboard?function(t){return navigator.clipboard.writeText(t)}(t):(function(t){var e=document.createElement("input"),n=document.activeElement;e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),n.focus()}(t),Promise.resolve())}n.d(e,{copyToClipboard:function(){return o}})},32609:function(t,e,n){"use strict";n.d(e,{logQuestionsClickEvent:function(){return c},logQuestionsOpeningEvent:function(){return l}});var o,r=n(74093),i=n(40517),s=n(19331),u=n(64260);!function(t){t.SNIPPET="snippet",t.URL="url",t.STORY="story"}(o||(o={}));var a=new(function(){function t(){this.productionStatCollector=new r.ProductionStatCollector,this.clickStatCollector=new r.ClickStatCollector(this.productionStatCollector)}return t.prototype.logClickEvent=function(t,e){var n;void 0===e&&(e={});var o=((n={type:i.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM})[i.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM]={type:t,screen:e.navScreen||window.cur.module||""},n);e.questionReceiverId&&(o[i.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_receiver_id=e.questionReceiverId),e.questionAuthorId&&(o[i.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_author_id=e.questionAuthorId),e.questionText&&(o[i.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_text=e.questionText);var r={type:i.EventItemType.QUESTION,id:e.questionId||0};(0,s.partConfigEnabled)("profile_questions_analytic_debug")&&console.log("--"+t,o,r),this.clickStatCollector.logEvent(o,r)},t.prototype.logOpeningEvent=function(t,e,n){var r;switch(e){case o.STORY:r=n===u.QuestionAnalyticBoxName.askQuestion?u.QuestionAnalyticEventType.openAskQuestionFromStory:u.QuestionAnalyticEventType.openMyQuestionsFromStory;break;case o.SNIPPET:r=n===u.QuestionAnalyticBoxName.askQuestion?u.QuestionAnalyticEventType.openAskQuestionFromSnippet:u.QuestionAnalyticEventType.openMyQuestionsFromSnippet;break;default:r=n===u.QuestionAnalyticBoxName.askQuestion?u.QuestionAnalyticEventType.openAskQuestionFromUrl:u.QuestionAnalyticEventType.openMyQuestionsFromUrl}var i={questionReceiverId:t};n===u.QuestionAnalyticBoxName.askQuestion&&(i.questionAuthorId=window.vk.id),this.logClickEvent(r,i)},t}());function c(t,e){void 0===e&&(e={}),a.logClickEvent(t,e)}function l(t,e,n){a.logOpeningEvent(t,e,n)}},64260:function(t,e,n){"use strict";n.d(e,{QuestionAnalyticEventType:function(){return o},QuestionAnalyticBoxName:function(){return r}});var o,r;n(40517);!function(t){t.clickToQuestion="click_to_question",t.reply="reply",t.replyAgain="reply_again",t.sharing="sharing",t.shareToStory="share_to_story",t.shareToWall="share_to_wall",t.shareToGroup="share_to_group",t.shareToIm="share_to_im",t.copyLink="copy_link",t.openStory="open_story",t.callFriends="call_friends",t.openSettings="open_settings",t.openProfile="open_profile",t.block="block",t.unblock="unblock",t.deleteAllQuestions="delete_all_questions",t.delete="delete",t.cancelDelete="cancel_delete",t.cancelDeleteAllAuthorQuestions="cancel_delete_all_author_questions",t.cancelDeleteAllAnonymousQuestions="cancel_delete_all_anonymous_questions",t.next="next",t.close="close",t.clickToSend="click_to_send",t.sendQuestion="send_question",t.cancelSendQuestion="cancel_send_question",t.cancelWriteAnswer="cancel_write_answer",t.closeMyQuestions="close_my_questions",t.openMyQuestionsFromUrl="open_my_questions_from_url",t.openAskQuestionFromUrl="open_ask_question_from_url",t.openMyQuestionsFromSnippet="open_my_questions_from_snippet",t.openAskQuestionFromSnippet="open_ask_question_from_snippet",t.openMyQuestionsFromStory="open_my_questions_from_story",t.openAskQuestionFromStory="open_ask_question_from_story"}(o||(o={})),function(t){t[t.askQuestion=0]="askQuestion",t[t.myQuestions=1]="myQuestions"}(r||(r={}))},41319:function(t,e,n){"use strict";var o,r,i,s,u;n.d(e,{StoryType:function(){return o},StoryEntryPoint:function(){return r},StorySource:function(){return i}}),function(t){t.PHOTO="photo",t.VIDEO="video",t.LIVE="live"}(o||(o={})),function(t){t.SWIPE="swipe",t.NAVIGATION_BUTTON="navigation_button",t.SIT_POSTING="sit_posting",t.LINK="link",t.STORY_REPLY="story_reply",t.STORY_REPOST="story_repost",t.CATALOG_ADD="catalog_add",t.DIALOG="dialog",t.STORY_LIVE_FINISHED="story_live_finished",t.DIALOG_VKME="dialog_vkme",t.STORY_VIEWER_FINISHED="story_viewer_finished",t.PUSH_TRY_MASK="push_try_mask",t.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",t.LINK_MASK="link_mask",t.POSTING="posting",t.NEW_STORY_AVATAR="new_story_avatar",t.STORY_REPLIES_LIST="story_replies_list",t.STORIES_FEED="stories_feed",t.STORIES_SEARCH_NEWS="stories_search_news",t.QUESTION_STICKER="question_sticker",t.LIST_MIDDLE="list_middle",t.ARCHIVE_EMPTY_BUTTON="archive_empty_button",t.ARCHIVE_MENU_BUTTON="archive_menu_button",t.IM="im",t.PROFILE_BUTTON="profile_button",t.SHARE="share",t.MINI_APP="mini_app",t.SYSTEM_SHARING="system_sharing",t.SHORTCUT="shortcut",t.ARCHIVE_SHARING="archive_sharing",t.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",t.STORY_VIEWER_MUSIC="story_viewer_music",t.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",t.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",t.CHANGE_AVATAR="change_avatar"}(r||(r={})),function(t){t.FEED="feed",t.FEED_MIDDLE="feed_middle",t.LINK="link",t.PROFILE="profile",t.IM_DIALOGS="im_dialogs",t.IM_DIALOG_HEADER="im_dialog_header",t.SNIPPET="snippet",t.REPLY="reply",t.REPLIES_LIST="replies_list",t.REPLY_STORY="reply_story",t.DISCOVER="discover",t.STORIES_MANAGE="stories_manage",t.USER_PERSONAL_CARD="user_personal_card",t.GROUP_PERSONAL_CARD="group_personal_card",t.NARRATIVE_SNIPPET="narrative_snippet",t.NARRATIVE_STORY="narrative_story",t.NARRATIVE_LINK="narrative_link",t.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",t.NARRATIVE_SECTION="narrative_section",t.FAVE="fave",t.SPAMFEED="sf",t.ADS_PREVIEW="ads_preview",t.LIST_MIDDLE="list_middle",t.PLACE_STORY_LIST="place_story_list",t.SEARCH_STORY_LIST="search_story_list",t.STORY_ARCHIVE="story_archive",t.IM_MSG_LIST="im_msg_list",t.NOSPAM="nospam",t.PROFILE_SNACKBAR="profile_snackbar",t.MY_QUESTIONS="questions"}(i||(i={})),function(t){t.stories="stories",t.communityGroupedStories="community_grouped_stories",t.appGroupedStories="app_grouped_stories",t.discover="discover"}(s||(s={})),function(t){t.feed="feed",t.groups="groups",t.apps="apps",t.discover="discover"}(u||(u={}))},69410:function(t,e,n){"use strict";n.d(e,{ImageItem:function(){return r}});var o=n(79573),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,o.__extends)(e,t),e.prototype.draw=function(t){var e=this.props,n=e.x,o=void 0===n?0:n,r=e.y,i=void 0===r?0:r,s=e.image,u=e.width,a=void 0===u?0:u,c=e.height,l=void 0===c?0:c,d=e.radius,f=void 0===d?0:d,_=e.borderSize,h=void 0===_?0:_,p=e.borderColor,g=void 0===p?"transparent":p,v=e.shadowBlur,m=void 0===v?0:v,E=e.shadowColor,y=void 0===E?"":E,T=Math.min(s.width,s.height),S=(s.width-T)/2,w=(s.height-T)/2;t.save(),t.lineWidth=h,t.strokeStyle=g,m&&y&&(t.shadowBlur=m,t.shadowColor=y,t.shadowOffsetX=1e4+o,t.shadowOffsetY=1e4+i,t.fillRect(-1e4,-1e4,a,a)),t.beginPath(),t.arc(o+f,i+f,f,Math.PI,Math.PI+Math.PI/2),t.lineTo(o+a-f,i),t.arc(o+a-f,i+f,f,Math.PI+Math.PI/2,2*Math.PI),t.lineTo(o+a,i+l-f),t.arc(o+a-f,i+l-f,f,2*Math.PI,Math.PI/2),t.lineTo(o+f,i+l),t.arc(o+f,i+l-f,f,Math.PI/2,Math.PI),t.closePath(),t.clip(),t.drawImage(s,S,w,T,T,o,i,a,l),t.stroke(),t.restore()},e.prototype.getWidth=function(){return this.props.width},e.prototype.setWidth=function(t){this.props.width=t},e.prototype.getHeight=function(){return this.props.height},e.prototype.setWeight=function(t){this.props.height=t},e}(n(76692).Shape)},76692:function(t,e,n){"use strict";n.d(e,{Shape:function(){return o}});var o=function(){function t(t){this.props=t}return t.prototype.getBoundingClientRect=function(){var t=this.props,e=t.x,n=void 0===e?0:e,o=t.y,r=void 0===o?0:o;return{width:this.getWidth(),height:this.getHeight(),top:r,left:n,right:n+this.getWidth(),bottom:r+this.getHeight()}},t.prototype.setX=function(t){this.props.x=t},t.prototype.setY=function(t){this.props.y=t},t}()},89746:function(t,e,n){"use strict";n.d(e,{TextItem:function(){return u}});var o,r=n(79573),i=n(76692),s=n(95283);!function(t){t.LEFT="LEFT",t.CENTER="CENTER"}(o||(o={}));var u=function(t){function e(e){var n=t.call(this,e)||this;return n.context=document.createElement("canvas").getContext("2d"),n.splitText=n.splitTextIntoLines(),n}return(0,r.__extends)(e,t),e.prototype.draw=function(t){var n=this,r=this.props,i=r.x,s=void 0===i?0:i,u=r.y,a=void 0===u?0:u,c=r.color,l=void 0===c?"#000":c,d=r.lineHeight,f=r.fillColor,_=r.fillRadius,h=void 0===_?0:_,p=r.align,g=void 0===p?o.LEFT:p,v=r.maxWidth,m=void 0===v?0:v,E=r.shadowBlur,y=r.shadowColor,T=r.maxLines,S=r.afterPadding,w=void 0===S?0:S;if(t.save(),this.setFont(t),t.fillStyle=l,t.textBaseline="top",t.textAlign="left",E&&y&&(t.shadowBlur=E,t.shadowColor=y),f){var A=this.getPadding(),I=0;this.splitText.forEach((function(r,i){var u=t.measureText(r).width;T&&i==n.splitText.length-1&&(u+=w);var a=s;g===o.CENTER&&(a=s+(m-u)/2);var c=0;c=0===i?A.top:A.top/2;var l=0;l=i===n.splitText.length-1?A.bottom:A.bottom/2;var _={tl:0,tr:0,bl:0,br:0};if(0===i)_.tl=h,_.tr=h,(p=t.measureText(n.splitText[i]).width)>(E=t.measureText(n.splitText[i+1]).width)&&(_.bl=0,_.br=h);else if(i===n.splitText.length-1){_.bl=h,_.br=h,(p=t.measureText(n.splitText[i]).width)>(v=t.measureText(n.splitText[i-1]).width)&&(_.tl=0,_.tr=h)}else{var p=t.measureText(n.splitText[i]).width,v=t.measureText(n.splitText[i-1]).width,E=t.measureText(n.splitText[i+1]).width;p>v&&(_.tl=0,_.tr=h),p>E&&(_.bl=0,_.br=h)}var y=d+c+l;e.drawFill(t,a,I,u+A.left+A.right,y,f,_),t.fillText(r,a+A.left,I+c),I+=y}))}else this.splitText.forEach((function(e,r){var i=t.measureText(e).width;T&&r==n.splitText.length-1&&(i+=w);var u=s;g===o.CENTER&&(u=s+(m-i)/2),t.fillText(e,u,a+d*r)}));t.restore()},e.drawFill=function(t,e,n,o,r,i,s){t.save(),t.beginPath(),t.fillStyle=i,t.lineWidth=0,t.strokeStyle="transparent",t.moveTo(e+s.tl,n),t.lineTo(e+o-s.tr,n),t.quadraticCurveTo(e+o,n,e+o,n+s.tr),t.lineTo(e+o,n+r-s.br),t.quadraticCurveTo(e+o,n+r,e+o-s.br,n+r),t.lineTo(e+s.bl,n+r),t.quadraticCurveTo(e,n+r,e,n+r-s.bl),t.lineTo(e,n+s.tl),t.quadraticCurveTo(e,n,e+s.tl,n),t.closePath(),t.stroke(),t.fill(),t.restore()},e.prototype.setFont=function(t){var e=this.props,n=e.fontSize,o=e.lineHeight,r=e.fontFamily,i=void 0===r?"sans-serif":r,s=e.fontWeight,u=void 0===s?"normal":s;t.font=u+" "+n+"px/"+o+"px "+i},e.prototype.splitLongWords=function(t){var e=this.context,n=this.props.maxWidth,o=void 0===n?0:n,i=[];return e&&o?(this.setFont(e),t.forEach((function(t){if("\n"!==t)if(e.measureText(t).width<=o)i.push(t);else{var n=Array.from(t).reduce((function(t,n){return e.measureText(t.current+n).width>o?{current:n,items:(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(t.items),!1),[t.current],!1)}:{current:t.current+n,items:(0,r.__spreadArray)([],(0,r.__read)(t.items),!1)}}),{current:"",items:[]});i.push.apply(i,(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(n.items),!1),[n.current],!1))}else i.push(t)})),i):t},e.prototype.splitTextIntoLines=function(){var t=this.context,e=this.props,n=e.text,o=e.maxWidth,r=void 0===o?0:o,i=e.maxLines,u=void 0===i?0:i,a=e.afterPadding,c=void 0===a?0:a,l=String((0,s.decodeHTMLEntities)(n)).replace(/(?:<br\s*\/?>)+/gim,"\n");if(!t)return l.split(/\n/);if(r<=0)return l.split(/\n/);this.setFont(t);for(var d=this.splitLongWords(l.replaceAll("\n"," \n ").split(" ")),f=0,_=[],h=function(){if(u&&_.length>=u-1){var e=d.splice(0).join(" ");if(t.measureText(e).width+c<=r)_.push(e);else{var n=t.measureText("...").width,o=!1,i=Array.from(e).reduce((function(e,i){var s=t.measureText(e+i).width;return!o&&s+n+c<=r?e+i:(o=!0,e)}),"");_.push(i.trim()+"...")}}else{var s=f+1,a="\n"===d[f],l=d.slice(0,s).join(" "),h=t.measureText(l).width;if(s>=d.length&&(h+=c),h>r||s>d.length||a){var p=d.splice(0,a?s:s-1);_.push(p.join(" ")),f=0}else f++}};d.length;)h();return _},e.prototype.getWidth=function(){var t=this.getLinesWidth();return 0===t.length?0:Math.max.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(t),!1))},e.prototype.getLinesWidth=function(){var t=this.context,e=this.props,n=e.maxLines,o=e.afterPadding,r=void 0===o?0:o;if(!t)return[];this.setFont(t);for(var i=this.getPadding(),s=[],u=0;u<this.splitText.length;u++){var a=t.measureText(this.splitText[u]).width;n&&u==this.splitText.length-1&&(a+=r),a+=i.left+i.right,s.push(Math.round(a))}return s},e.prototype.getHeight=function(){var t=this.getPadding(),e=this.props,n=e.fillColor,o=e.lineHeight;if(n){var r=this.splitText.length*o,i=(this.splitText.length-1)*(t.top+t.bottom)/2;return t.top+r+i+t.bottom}return this.splitText.length*(o+t.top+t.bottom)},e.prototype.getPadding=function(){var t=this.props.padding,e=void 0===t?0:t;return"number"==typeof e?{top:e,bottom:e,left:e,right:e}:e},e}(i.Shape)},59367:function(t,e,n){"use strict";n.d(e,{Sticker:function(){return i}});var o=n(79573),r=n(31927),i=function(){function t(){this.layers=[],this.images=[],this.width=0,this.height=0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}return t.prototype.drawScene=function(){var t=this.ctx;t&&(this.canvas.width=this.getWidth(),this.canvas.height=this.getHeight(),t.clearRect(0,0,this.canvas.width,this.canvas.height),this.layers.forEach((function(e){e.draw(t)})))},t.prototype.add=function(t){this.layers.push(t)},t.prototype.getCanvas=function(){return this.canvas},t.prototype.toBlob=function(){var t=this;return new Promise((function(e,n){t.canvas.toBlob((function(t){t||n(),e(t)}),"image/png",1)}))},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.setWidth=function(t){this.width=t},t.prototype.setHeight=function(t){this.height=t},t.prototype.loadImages=function(t){var e=this;return new Promise((function(n,i){var s,u,a=[];try{for(var c=(0,o.__values)(Object.entries(t)),l=c.next();!l.done;l=c.next()){var d=(0,o.__read)(l.value,2),f=d[0],_=d[1];f&&_&&a.push((0,r.loadImage)(_,f))}}catch(t){s={error:t}}finally{try{l&&!l.done&&(u=c.return)&&u.call(c)}finally{if(s)throw s.error}}Promise.all(a).then((function(t){e.images=t,n(1)})).catch((function(t){i(t)}))}))},t.prototype.getIconUrl=function(t){return URL.createObjectURL(new Blob([t],{type:"image/svg+xml"}))},t.prototype.getImage=function(t){return this.images.find((function(e){return e.dataset.name===t}))},t}()},31927:function(t,e,n){"use strict";function o(t,e){return new Promise((function(n,o){var r=new Image;r.crossOrigin="Anonymous",e&&(r.dataset.name=e),r.onerror=function(){o(new Error("Failed to load image's URL: "+t))},r.onload=function(){n(r)},r.src=t}))}n.d(e,{loadImage:function(){return o}})},98966:function(t,e,n){"use strict";n.d(e,{QUESTION_MAX_LENGTH:function(){return o},QUESTION_MAX_NEW_LINES:function(){return r}});var o=80,r=3},51888:function(t,e,n){"use strict";n.d(e,{getQuestion:function(){return r},getQuestions:function(){return i},deleteQuestion:function(){return s},restoreQuestion:function(){return u},deleteFromAuthor:function(){return a},restoreAuthorQuestions:function(){return c},sendQuestion:function(){return l},getUsers:function(){return d},banUser:function(){return f},unbanUser:function(){return _},reportQuestion:function(){return h}});var o=n(95036);function r(t){return(0,o.api)("questions.getById",{owner_id:window.vk.id,question_id:t,extended:1,fields:"photo_50,photo_100,first_name_gen,last_name_gen,domain"})}function i(t,e){return void 0===t&&(t=""),void 0===e&&(e=15),(0,o.api)("questions.get",{owner_id:window.vk.id,start_from:t,limit:e,extended:1,fields:"photo_50,photo_100,first_name_gen,last_name_gen,domain"})}function s(t){return(0,o.api)("questions.delete",{owner_id:window.vk.id,question_id:t})}function u(t){return(0,o.api)("questions.restore",{owner_id:window.vk.id,question_id:t})}function a(t){return(0,o.api)("questions.deleteFromAuthor",{owner_id:window.vk.id,question_id:t})}function c(t){return(0,o.api)("questions.restoreFromAuthor",{owner_id:window.vk.id,question_id:t})}function l(t,e,n){return void 0===n&&(n=!1),(0,o.api)("questions.send",{owner_id:t,text:e,is_anonymous:n?1:0})}function d(t){return(0,o.api)("users.get",{user_ids:t.join(","),fields:"photo_50,photo_100,can_ask_anonymous,can_ask_question,first_name_nom,first_name_dat,first_name_gen,last_name_gen,sex"})}function f(t){return(0,o.api)("questions.authorBan",{owner_id:window.vk.id,question_id:t})}function _(t){return(0,o.api)("questions.authorUnBan",{owner_id:window.vk.id,question_id:t})}function h(t){return(0,o.api)("reports.add",{type:"profile_story_question",owner_id:window.vk.id,item_id:t})}}}]);